<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
    <script>
        // let host = 'https://www.love-button.org/'
        let host = 'http://localhost:8080/api/'
        $(document).ready(function() {
            var token
            if (localStorage.getItem('loveButtonAuthToken')) {
                console.log("logged in")
                token = localStorage.getItem('loveButtonAuthToken')
            } else {
                console.log("redirecting to login")
                window.location.replace('/login')
            }

            $.get(
            {
                url: `${host}loadAccount`,
                beforeSend: function(xhr){xhr.setRequestHeader('Authorization', token)},
                success: function(res) {
                    console.log("success!")
                    console.log(document.getElementById('email'))
                    console.log(res)
                    document.getElementById('username').innerHTML = res.username,
                    document.getElementById('email').innerHTML = res.email,
                    document.getElementById('memo').innerHTML = res.memo,
                    document.getElementById('balance').innerHTML = res.balance,
                    document.getElementById('createdAt').innerHTML = res.createdAt
                },
                error: function() {
                    console.log("redirecting to login")
                    window.location.replace('/login')
                }
            }
        )
    })
    </script>
    <style>
        .bg-orange {
            background-color: #d21717;
        }
    </style>
</head>
<body class="container-fluid">
<header class="row bg-orange mb-3">
    <h1 class="col-xs-12 offset-sm-1 col-sm-10 offset-md-2 col-md-8 offset-lg-3 col-lg-6 text-white">Account Info
        Page</h1>
</header>
<div class="row">
    <section class="col-xs-12 offset-sm-1 col-sm-10 offset-md-2 col-md-8 offset-lg-3 col-lg-6">

        <div class="row">
            <h4 id="username" class="col">loading...</h4>
        </div>

        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text" id="email-label">Email:</span>
            </div>
            <p type="text" class="form-control" id="email" value="loading..."></p>
        </div>

        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text" id="memo-label">Memo (Account number):</span>
            </div>
            <p type="text" class="form-control" id="memo" value="loading..."></p>
        </div>

        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <span class="input-group-text" id="balance-label">Tipping balance:</span>
            </div>
            <p type="text" class="form-control" id="balance" value="loading..."></p>
        </div>

        <div class="row">
            <div class="col"><span>Created On: </span><span id="createdAt">loading...</span>
            </div>
        </div>
    </section>
</div>
</body>
</html>